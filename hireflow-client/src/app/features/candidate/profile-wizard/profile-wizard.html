<div class="min-h-screen bg-surface-50 flex items-center justify-center p-4 md:p-6">
    
    <div class="w-full max-w-4xl bg-white rounded-2xl shadow-xl border border-surface-200 overflow-hidden">
        
        <div class="bg-white px-8 py-6 border-b border-surface-100 text-center">
            <h1 class="text-2xl font-bold text-slate-900 tracking-tight">Complete Your Profile</h1>
            <p class="text-slate-500 text-sm mt-1">Step {{ activeStep }} of 3</p>
        </div>

        <p-stepper [(value)]="activeStep" class="w-full">
            
            <p-step-list class="flex items-center w-full px-8 py-6 bg-surface-0 border-b border-surface-100">
                
                <p-step [value]="1" class="flex-1">
                    <div class="flex items-center w-full cursor-pointer group" (click)="activeStep = 1">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-colors duration-300 border-2"
                                [class.bg-primary-500]="activeStep >= 1"
                                [class.border-primary-500]="activeStep >= 1"
                                [class.text-white]="activeStep >= 1"
                                [class.bg-white]="activeStep < 1"
                                [class.text-surface-500]="activeStep < 1"
                                [class.border-surface-300]="activeStep < 1">
                                <i *ngIf="activeStep > 1" class="pi pi-check text-xs"></i>
                                <span *ngIf="activeStep <= 1">1</span>
                            </div>
                            <span class="text-sm font-medium transition-colors duration-300"
                                  [class.text-primary-700]="activeStep === 1"
                                  [class.text-slate-900]="activeStep > 1"
                                  [class.text-surface-500]="activeStep < 1">
                                Contact
                            </span>
                        </div>
                        
                        <div class="h-[2px] w-full mx-4 rounded"
                             [class.bg-primary-500]="activeStep > 1"
                             [class.bg-surface-200]="activeStep <= 1">
                        </div>
                    </div>
                </p-step>

                <p-step [value]="2" class="flex-1">
                    <div class="flex items-center w-full cursor-pointer group" (click)="activeStep = 2">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-colors duration-300 border-2"
                                [class.bg-primary-500]="activeStep >= 2"
                                [class.border-primary-500]="activeStep >= 2"
                                [class.text-white]="activeStep >= 2"
                                [class.bg-white]="activeStep < 2"
                                [class.text-surface-500]="activeStep < 2"
                                [class.border-surface-300]="activeStep < 2">
                                <i *ngIf="activeStep > 2" class="pi pi-check text-xs"></i>
                                <span *ngIf="activeStep <= 2">2</span>
                            </div>
                            <span class="text-sm font-medium transition-colors duration-300 whitespace-nowrap"
                                  [class.text-primary-700]="activeStep === 2"
                                  [class.text-slate-900]="activeStep > 2"
                                  [class.text-surface-500]="activeStep < 2">
                                Education
                            </span>
                        </div>
                        
                        <div class="h-[2px] w-full mx-4 rounded"
                             [class.bg-primary-500]="activeStep > 2"
                             [class.bg-surface-200]="activeStep <= 2">
                        </div>
                    </div>
                </p-step>

                <p-step [value]="3" class="w-auto">
                    <div class="flex items-center cursor-pointer group" (click)="activeStep = 3">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-colors duration-300 border-2"
                                [class.bg-primary-500]="activeStep >= 3"
                                [class.border-primary-500]="activeStep >= 3"
                                [class.text-white]="activeStep >= 3"
                                [class.bg-white]="activeStep < 3"
                                [class.text-surface-500]="activeStep < 3"
                                [class.border-surface-300]="activeStep < 3">
                                3
                            </div>
                            <span class="text-sm font-medium transition-colors duration-300"
                                  [class.text-primary-700]="activeStep === 3"
                                  [class.text-slate-900]="activeStep > 3"
                                  [class.text-surface-500]="activeStep < 3">
                                Resume
                            </span>
                        </div>
                        </div>
                </p-step>

            </p-step-list>

            <p-step-panels>
                 <p-step-panel [value]="1">
                    <ng-template pTemplate="content" let-activateCallback="activateCallback">
                         <div class="p-8 md:p-12 flex flex-col gap-8" [formGroup]="profileForm">
                            <div class="text-center md:text-left">
                                <h2 class="text-xl font-bold text-slate-900">Let's start with the basics</h2>
                                <p class="text-slate-500 mt-1">Recruiters use this info to contact you.</p>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="flex flex-col gap-2">
                                    <label class="text-sm font-semibold text-slate-700">Phone Number</label>
                                    <div class="relative">
                                        <i class="pi pi-phone absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 z-10"></i>
                                        <input pInputText formControlName="phoneNumber" placeholder="+1 234 567 890" class="w-full pl-10 !py-3" />
                                    </div>
                                    <small class="text-red-500" *ngIf="profileForm.get('phoneNumber')?.invalid && profileForm.get('phoneNumber')?.touched">
                                        Valid phone number required
                                    </small>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <label class="text-sm font-semibold text-slate-700">LinkedIn URL</label>
                                    <div class="relative">
                                        <i class="pi pi-linkedin absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 z-10"></i>
                                        <input pInputText formControlName="linkedInUrl" placeholder="linkedin.com/in/username" class="w-full pl-10 !py-3" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="px-8 pb-8 flex items-center justify-between">
                            <p-button label="Cancel" severity="secondary" [text]="true" size="small" class="text-slate-400 hover:text-slate-600"></p-button>
                            <p-button label="Next Step" icon="pi pi-arrow-right" iconPos="right" (onClick)="activateCallback(2)" styleClass="px-6 py-3 bg-primary-600 border-primary-600 hover:bg-primary-700 shadow-lg shadow-primary-500/30 rounded-xl"></p-button>
                        </div>
                    </ng-template>
                </p-step-panel>

                <p-step-panel [value]="2">
                     <ng-template pTemplate="content" let-activateCallback="activateCallback">
                        <div class="p-8 md:p-12 flex flex-col gap-8" [formGroup]="profileForm">
                            <div class="text-center md:text-left">
                                <h2 class="text-xl font-bold text-slate-900">Academic Background</h2>
                                <p class="text-slate-500 mt-1">Tell us about your highest level of education.</p>
                            </div>
                            <div class="w-full max-w-lg">
                                <label class="text-sm font-semibold text-slate-700 block mb-2">Highest Degree Achieved</label>
                                <p-select [options]="educationLevels" formControlName="educationLevel" optionLabel="label" optionValue="value" placeholder="Select your education level" styleClass="w-full !border-slate-300 !py-1" [filter]="false"></p-select>
                            </div>
                        </div>
                        <div class="px-8 pb-8 flex items-center justify-between">
                            <p-button label="Back" severity="secondary" [text]="true" icon="pi pi-arrow-left" (onClick)="activateCallback(1)" class="text-slate-500 hover:text-slate-700"></p-button>
                            <p-button label="Next Step" icon="pi pi-arrow-right" iconPos="right" (onClick)="activateCallback(3)" styleClass="px-6 py-3 bg-primary-600 border-primary-600 hover:bg-primary-700 shadow-lg shadow-primary-500/30 rounded-xl"></p-button>
                        </div>
                    </ng-template>
                </p-step-panel>

                <p-step-panel [value]="3">
                     <ng-template pTemplate="content" let-activateCallback="activateCallback">
                        <div class="p-8 md:p-12 flex flex-col gap-8" [formGroup]="profileForm">
                            <div class="text-center md:text-left">
                                <h2 class="text-xl font-bold text-slate-900">Upload Resume</h2>
                                <p class="text-slate-500 mt-1">Upload your CV to complete your profile (PDF or DOCX).</p>
                            </div>
                            <p-fileupload mode="advanced" [auto]="true" customUpload="true" (onSelect)="onFileUpload($event)" accept=".pdf,.docx" [maxFileSize]="5000000" [showUploadButton]="false" [showCancelButton]="false" styleClass="w-full">
                                <ng-template pTemplate="content">
                                    <div class="py-12 flex flex-col items-center justify-center border-2 border-dashed border-slate-300 rounded-xl bg-slate-50 hover:bg-slate-100 transition-colors cursor-pointer group" *ngIf="!profileForm.value.resumeUrl">
                                        <div class="w-16 h-16 bg-white rounded-full shadow-sm flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                                            <i class="pi pi-cloud-upload text-3xl text-primary-500"></i>
                                        </div>
                                        <p class="font-semibold text-slate-700">Drag & Drop or Click to Upload</p>
                                        <p class="text-sm text-slate-500 mt-1">Supported formats: PDF, DOCX (Max 5MB)</p>
                                    </div>
                                    <div class="py-10 flex flex-col items-center justify-center border-2 border-green-200 rounded-xl bg-green-50 animate-in fade-in zoom-in duration-500" *ngIf="profileForm.value.resumeUrl">
                                        <div class="w-16 h-16 bg-white rounded-full shadow-sm flex items-center justify-center mb-4 border border-green-100">
                                            <i class="pi pi-check text-3xl text-green-600"></i>
                                        </div>
                                        <p class="font-bold text-green-800 text-lg">Resume Uploaded Successfully!</p>
                                        <p class="text-sm text-green-600 mt-1">Ready to submit.</p>
                                    </div>
                                </ng-template>
                            </p-fileupload>
                        </div>
                        <div class="px-8 pb-8 flex items-center justify-between border-t border-slate-100 pt-6">
                            <p-button label="Back" severity="secondary" [text]="true" icon="pi pi-arrow-left" (onClick)="activateCallback(2)" class="text-slate-500 hover:text-slate-700"></p-button>
                            <p-button label="Finish & Submit" icon="pi pi-check" [loading]="store.isLoading()" [disabled]="profileForm.invalid" (onClick)="submitProfile()" styleClass="px-8 py-3 bg-green-600 border-green-600 hover:bg-green-700 shadow-lg shadow-green-600/20 rounded-xl"></p-button>
                        </div>
                    </ng-template>
                </p-step-panel>

            </p-step-panels>
        </p-stepper>
    </div>
</div>